
<div class="content">
  <div class="card">
    <h2 class="card-title card-divider">
      Spam Filter
    </h2>
    <div class="card-content card-section">
      The spam filter is an automatic process that is active in the following situations: 
      <ol>
        <li>When a user tries to save his account or write a comment</li>
        <li>Every day, on the whole database</li>
      </ol>

      The spam filter will do the following action: 
      <ul>
        <li>Check if the user's content is a detected as a spam</li>
        <li>Quarantine: Block the user and hide it's content</li>
        <li>Ban: Remove the user and all his data</li>
      </ul>

      <strong>RGPD</strong><br />
      Please be sure your <a href="/terms-and-conditions">Terms and Conditions</a> are transparent over this
      process, to be compliant with the European regulations. Users should be noticed on the the conditions that their
      account and data may be deleted if the Automatic Spam Filter detects suspicious activities.
    </div>
  </div>
</div>
<style>
.spam_signal__metric {
  font-size: 2rem;
  font-weight: bold;
  font-family: Courrier, monospace;
}
</style>
<div class="content">
  <h2>Spam activities</h2>
  <div class="grid-x grid-margin-x">
        <div class="cell small-4 callout">
          <h5>Quarantine</h5>
          <div class="spam_signal__metric"><%= quarantine.count %></div>
            <% if quarantine.count > 0 %><a href="#review-quarantine">Get the list</a><% end %>
        </div>
        <div class="cell small-4 callout">
          <h5>To ban</h5>
          <div class="spam_signal__metric"><%= to_ban.count %></div>
          <% if to_ban.count > 0 %> <a href="#">Review to clean</a><% end %>
        </div>
        <div class="cell small-4 callout">
          <h5>Banned</h5>
          <div class="spam_signal__metric"><%= banned.count %></div>
          <% if banned.count > 0 %> <a href="#">Banned list</a><% end %>
        </div>
  </div>
  <% if quarantine.count > 0 %>
  <div class="grid-x grid-margin-x" id="review-quarantine">
      <div class="cell small-12">
        <h2>Quarantine</h2>
      
        <div class="table-scroll">
          <table class="table-list">
            <thead>
              <tr>
                <th>Reported at</th>
                <th>Reported Contact</th>
                <th>Suspicious User Contact</th>
                <th>Account Confirmed ?</th>
                <th><%= t("models.user.fields.created_at", scope: "decidim.admin") %></th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <% quarantine.each do |report| %>
                <% user = report.banned_user %>
                <tr data-user-id="<%= user.id %>">
                  <td><%= l report.notified_at, format: :short %></td>
                  <td><%= report.admin_reporter.name %> &lt;<%= report.admin_reporter.email %>&gt;</td>
                  <td><%= user.name %> &lt;<%= user.email %>&gt;</td>
                  <td>
                    <%= user.confirmed? ? "✓" : "⨯" %>
                  </td>
                  <td><%= l user.created_at, format: :short %></td>
                  <td class="table-list__actions">
                    <%= link_to("Review", quarantine_path(report), class: "button hollow expanded button--sc mt-s") %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
          <%= paginate quarantine, theme: "decidim" %>
        </div>
      </div>
  </div>
</div>
<% end %>